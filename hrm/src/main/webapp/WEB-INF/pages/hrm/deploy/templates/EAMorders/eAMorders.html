<div ng-controller=OrdersCtrl><style>
        .alert-danger, .alert-error {
            color: #b94a48;
            background-color: #f2dede;
            border-color: #eed3d7;
        }
    </style><div class="panel panel-default" style="margin-bottom: 10px;"><div class="panel-heading font-bold">报班单批注</div><div class=panel-body style="padding: 15px;" id=panelBody><form class="ng-pristine ng-valid" role=form><div class=col-lg-6><div class=form-group><label class="col-sm-3 fl" style="line-height: 34px;">搜索关键字</label><div class="input-group col-sm-9"><input type=text class=form-control ng-model=search_info></div></div></div><div class=col-lg-6 align=left><button type=submit class="btn btn-default" ng-click=queryInfo()>查询</button></div></form></div></div><div class="alert fade in alert-info" id=help><p>功能说明:</p><p>1、报班单批注功能，提供财务专员查询ERP的报班单，并根据需要批注报班单到外账系统；</p><p>2、报班单批注功能，支持批注到科目；</p><p>3、被批注的报班单，或科目，后续的报班作废、退费/退费作废、转班、考勤数据全部自动同步；</p><p>4、被批注的报班单，或科目，取消批注的时候，之前同步的数据，将保留；</p></div><div><div class=tool_bar><button type=button style=margin-left:5px; class="btn btn-default" ng-repeat="company in companys" ng-click=selectCompany(company)>{{company.name}}</button> <a href=#/financial/ExternalAccountManagement/fileUpload class="btn btn-default">导入</a> <button type=button class="btn btn-default" ng-click=exports()>导出</button></div><div style="margin-top: 10px;overflow-x: scroll;min-height: 300px;"><table class="table table-hover table-striped"><col align=center width=5%><col align=center width=17%><col align=center width=20%><col align=center width=10%><col align=center width=15%><col align=center width=10%><col align=center width=10%><col align=center width=13%><tr><th><input type=checkbox ng-click=checkAllOrder() checked ng-if=checkAll> <input type=checkbox ng-click=checkAllOrder() ng-if=!checkAll></th><th>编码</th><th>姓名/编码</th><th>金额</th><th>公司</th><th>缴费人</th><th>缴费时间</th><th>操作</th></tr><tr ng-repeat="order in orderData" order=order ng-if="orderData&&orderData.length>0" class=cur><td colspan=8><table style=width:100%;><col align=center width=5%><col align=center width=17%><col align=center width=20%><col align=center width=10%><col align=center width=15%><col align=center width=10%><col align=center width=10%><col align=center width=13%><tr><td><input type=checkbox ng-click=checkOrder(order) checked ng-if=order.checked> <input type=checkbox ng-click=checkOrder(order) ng-if=!order.checked></td><td ng-click=showDetail(order)>{{order.order_no}}</td><td ng-click=showDetail(order)>{{order.student_name}}<span style="font-size: 12px;color: #999;">（{{order.student_encoding}}）</span></td><td ng-click=showDetail(order)>{{order.amount}}<span style="font-size: 12px;color: #999;">（{{order.actual_amount | number : 2}}）</span></td><td ng-click=showDetail(order)>{{order.company_name?order.company_name:'-'}}</td><td ng-click=showDetail(order)>{{order.payerName?order.payerName:'-'}}</td><td ng-click=showDetail(order)>{{order.payerTime?order.payerTime:'-'}}</td><td><a ng-if=!order.sync ng-click=orderSync(order)>启动同步</a> <a ng-if=order.sync ng-click=orderSync(order)>取消同步</a></td></tr><tr ng-if=order.showDetail><td colspan=8><div style="background-color: #fff;"><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">订单ID</label><p class="col-sm-10 form-control-static">{{order.id}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">业务校区</label><p class="col-sm-10 form-control-static">{{order.branch_name}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">现金</label><p class="col-sm-10 form-control-static">{{order.cash}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">刷卡</label><p class="col-sm-10 form-control-static">{{order.payByCard}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">转账</label><p class="col-sm-10 form-control-static">{{order.transfer}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">储值账户</label><p class="col-sm-10 form-control-static">{{order.account}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">批注人</label><p class="col-sm-10 form-control-static">{{order.commentPersonName}}</p></div><div class="form-group col-lg-6"><label class=col-sm-2 style="line-height: 34px;">批注时间</label><p class="col-sm-10 form-control-static">{{order.commentTime}}</p></div><div class=form-group><label class=col-sm-2>课程列表</label><p class="col-sm-10 form-control-static"></p></div></div><table class=table><col align=center width=10%><col align=center width=30%><col align=center width=10%><col align=center width=10%><col align=center width=10%><col align=center width=10%><col align=center width=10%><col align=center width=10%><tr><th>详单ID</th><th>课程名称/编码</th><th>老师/编码</th><th>金额</th><th>内账学生数</th><th>外账学生数</th><th>占比</th><th>操作</th></tr><tr ng-repeat="course in order.orderCourses" ng-if=order.orderCourses&&order.orderCourses.length><td>{{course.orderCourseId}}</td><td><p>{{course.courseMame}}</p><p style="font-size: 12px;color: #999;">{{course.courseCode}}</p></td><td><p>{{course.teacherName}}</p><p style="font-size: 12px;color: #999;">{{course.teacherCode}}</p></td><td>{{course.orderCourseActualAmount | number : 2}}</td><td><a href=javascript:void(0) ng-click=queryERPStudentList(course)><i class="fa fa-hand-pointer-o"></i> {{course.numberERP}}</a></td><td><a href=javascript:void(0) ng-click=queryPUBStudentList(course)><i class="fa fa-hand-pointer-o"></i> {{course.numberPUB}}</a></td><td>{{course.rate}}%</td><td><a ng-if=!course.sync ng-click=orderSync(course)>启动同步</a> <a ng-if=course.sync ng-click=orderSync(course)>取消同步</a></td></tr><tr ng-if=!order.orderCourses||!order.orderCourses.length><td colspan=8 align=center>暂无数据</td></tr><tr ng-if="order.isLoadingCourses == 'loading...'"><td colspan=8 align=center><img src=img/icons/big_load.gif></td></tr></table></td></tr></table></td></tr><tr ng-if="isLoadingOrders == 'loading...'"><td colspan=8 align=center><img src=img/icons/big_load.gif></td></tr><tr ng-if="!orderData||!orderData.length&&isLoadingOrders==''"><td colspan=8 align=center>没有数据</td></tr></table></div><div class=fr ng-if="totalPage>=1"><ul class=pagination><li ng-model=currentPage ng-if="totalPage>=1" ng-click=queryIndex(1)><span>首页</span></li><li ng-if="currentPage>1" ng-click=queryIndex(currentPage-1)><span>上一页</span></li><li ng-repeat="i in paginationBars track by $index" class="{{ i==currentPage ? 'active':'' }}"><span ng-click=queryIndex(i)>{{i}}</span></li><li ng-model=currentPage ng-if="currentPage<totalPage" ng-click=queryIndex(currentPage+1)><span>下一页</span></li><li ng-model=totalPage ng-click=queryIndex(totalPage)><span>尾页</span></li></ul></div></div><div ng-include="'templates/segment/student_list.html'"></div></div>