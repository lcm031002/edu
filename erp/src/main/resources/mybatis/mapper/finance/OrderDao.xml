<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.erp.dao.OrderDao">

	<!-- 查询教师信息列表 -->
	<select id="page" resultType="map" parameterType="java.util.Map">
		select o.id orderId,
		       o.order_no orderNo,
		       case when o.order_type = 1 then '原单'
		            when o.order_type = 2 then '赠单'
		            when o.order_type = 3 then '转班单'
		            when o.order_type = 4 then '续单' else '' end orderType,
		       o.fee_amount feeAmount,
		       o.actural_amount acturalAmount,
		       case when o.business_type = 1 then '班级课'
		            when o.business_type = 2 then '一对一'
		            when o.business_type = 3 then '晚辅导' else '' end businessType,
		       stu.student_name || '(' || stu.id || ')('|| stu.encoding || ')' studentInfo,
		       ei.employee_name employeeName,
		       to_char(o.create_date,'yyyy-mm-dd hh24:mi:ss') createDate
		  from t_order o
		  join tab_student_info stu on o.student_id = stu.id
		  join tab_employee_info ei on ei.id = o.agent_id 
		 where 1 = 1
		   <if test="order_no != null and  order_no != ''">
		   		and o.order_no = #{order_no}
		   </if>
		   <if test="order_type != null and  order_type != ''">
		   		and o.order_type = #{order_type}
		   </if>
		   <if test="business_type != null and  business_type != ''">
		   		and o.business_type = #{business_type}
		   </if>
		   <if test="stu_encoding != null and  stu_encoding != ''">
		   		and stu.stu_encoding = #{stu_encoding}
		   </if>
		   <if test="stdent_name != null and  stdent_name != ''">
		   		and stu.stdent_name like '%' || #{stdent_name} || '%' 
		   </if>
		  order by o.id desc
	</select>

</mapper>