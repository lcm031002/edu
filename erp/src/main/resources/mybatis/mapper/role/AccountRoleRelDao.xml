<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.erp.dao.AccountRoleRelDao">

    <!-- 根据指定账户查询角色 -->
    <select id="queryRoleWithAccount" parameterType="long" resultType="java.util.Map">
		select ear.role_id as "id" ,trf.role_name as "roleName", ear.id as "accountRoleId"
		  from tab_user_role_ref ear 
		join tab_role_info trf
		on ear.role_id=trf.id
		where ear.user_id=#{user_id,jdbcType =NUMERIC}
		and trf.status=1
	</select>

    <!-- 添加账户角色列表 -->
    <insert id="addAccountRole" parameterType="map">
        INSERT INTO tab_user_role_ref (user_id,role_id) values
            <foreach collection="roleList" item="element" index="index" separator =",">
                (#{id}, #{element.id})
            </foreach>
    </insert>

    <!-- 删除账户角色关系 -->
    <delete id="deleteAccountRole" parameterType="long">
		delete from tab_user_role_ref where user_id=#{user_id,jdbcType = NUMERIC}
	</delete>

    <delete id="deleteAccountRoleById" parameterType="long">
		delete from tab_user_role_ref where id = #{id, jdbcType = NUMERIC}
	</delete>

</mapper>