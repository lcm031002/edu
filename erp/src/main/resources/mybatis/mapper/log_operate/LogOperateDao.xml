<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.erp.dao.LogOperateDao">
	<insert id="insertBySQLID"  parameterType="java.util.HashMap">
		<selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER" >
      		SELECT seq_business_operate_log.currval as id from dual
   		</selectKey>
		insert into business_operate_log t 
		(
			t.ID,
			t.CREATETIME,
			t.BUSINESSNAME,
			t.DETAILINFO,
			t.OPERATER,
			t.STATUS
		)   
		values 
		(
			seq_business_operate_log.nextval,
			#{CREATETIME,jdbcType=DATE},
			#{BUSINESSNAME,jdbcType=VARCHAR},
			#{DETAILINFO,jdbcType=VARCHAR},
			#{OPERATER,jdbcType=VARCHAR},
			#{STATUS,jdbcType=VARCHAR}
		)
	</insert>
	
	<insert id="insertEaiLog"  parameterType="java.util.HashMap">
		<selectKey resultType="java.lang.Long" keyProperty="id" order="BEFORE">
			select  seq_eai_log_info.nextval as id from dual
		</selectKey>
		insert into tab_eai_log_info t 
		(
			t.id,
			t.log_type,
			t.source_sys,
			t.in_sys,
			t.send_data,
			t.back_data,
			t.status,
		  <if test="method != null and method != ''">
				t.method,
			</if>
			<if test="busi_id != null and busi_id != ''">
				t.busi_id,
			</if>
			t.create_user,
			t.create_time
		)   
		values 
		(
			#{id,jdbcType=NUMERIC},
			#{log_type,jdbcType=NUMERIC},
			#{source_sys,jdbcType=VARCHAR},
			#{in_sys,jdbcType=VARCHAR},
			#{send_data,jdbcType=VARCHAR},
			#{back_data,jdbcType=VARCHAR},
			#{status,jdbcType=NUMERIC},
		  <if test="method != null and method != ''">
				#{method, jdbcType=VARCHAR},
			</if>
			<if test="busi_id != null and busi_id != ''">
				#{busi_id, jdbcType=VARCHAR},
			</if>
			#{create_user,jdbcType=NUMERIC},
			#{create_time,jdbcType=TIMESTAMP}
		)
	</insert>

	<select id="queryEaiLogInfoForPage" parameterType="map" resultType="com.edu.erp.model.EaiLogInfo">
		select teli.id,
					 teli.log_type,
					 teli.source_sys,
					 teli.in_sys,
					 teli.status,
		       decode(teli.status, 1, '成功', '失败') as status_name,
					 teli.method,
					 teli.busi_id,
					 teli.send_data,
					 teli.back_data
			from tab_eai_log_info teli
		 where 1 = 1
		 <if test="status != null">
			 and teli.status = #{status}
		 </if>
		 <if test="log_type != null">
			 teli.log_type = #{log_type}
		 </if>
	</select>

	<select id="queryEaiLogInfoById" parameterType="long" resultType="com.edu.erp.model.EaiLogInfo">
		select teli.id,
					 teli.log_type,
					 teli.source_sys,
					 teli.in_sys,
					 teli.status,
					 teli.method,
					 teli.busi_id,
					 teli.send_data,
					 teli.back_data
			from tab_eai_log_info teli
		 where id = #{id}
	</select>
</mapper>